{"version":3,"file":"index.umd.js","sources":["src/useFetchAPI.ts","src/useCounter.ts","src/useDebounce.ts","src/useFetch.ts","src/useLocalStorage.ts","src/useOutsideClick.ts","src/useSessionStorage.ts","src/useTimeout.ts","src/useWindowSize.ts"],"sourcesContent":["import axios, { AxiosRequestConfig, Method } from \"axios\";\nimport { useEffect, useState, useRef } from \"react\";\n\n// 用來儲存緩存的數據\nconst cache: Record<string, any> = {};\n\ntype UseFetchProps = {\n  method?: Method;\n  headers?: Record<string, string>;\n  options?: AxiosRequestConfig;\n};\n\ntype UseFetchState<T> = {\n  data: T | null;\n  loading: boolean;\n  error: {\n    message: string;\n    code?: number;\n  } | null;\n};\n\nexport function useFetchAPI<T>(\n  url: string,\n  { method, headers, options }: UseFetchProps = { method: \"GET\" }\n): UseFetchState<T> {\n  const cacheKey = useRef(`${method}-${url}-${JSON.stringify(options)}`);\n  const [state, setState] = useState<UseFetchState<T>>({\n    data: null,\n    loading: true,\n    error: null,\n  });\n\n  useEffect(() => {\n    const controller = new AbortController();\n\n    // 檢查緩存\n    if (cache[cacheKey.current]) {\n      setState({\n        data: cache[cacheKey.current],\n        loading: false,\n        error: null,\n      });\n      return;\n    }\n\n    // 發出新請求\n    const fetchData = async () => {\n      try {\n        const res = await axios({\n          method,\n          url,\n          headers,\n          signal: controller.signal,\n          ...options,\n        });\n\n        // 更新緩存\n        cache[cacheKey.current] = res.data;\n\n        setState({\n          data: res.data,\n          loading: false,\n          error: null,\n        });\n      } catch (error) {\n        setState({\n          data: null,\n          loading: false,\n          error: {\n            message: error.message,\n            code: error.response?.status,\n          },\n        });\n      }\n    };\n\n    fetchData();\n\n    return () => {\n      controller.abort();\n    };\n  }, [url, method, headers, options]);\n\n  return state;\n}\n","import React, { useState } from \"react\";\n\nexport function useCounter(initialValue?: number) {\n  const [count, setCount] = useState(initialValue || 0);\n\n  // Increase 1\n  function increment() {\n    setCount((prevCount: number) => prevCount + 1);\n  }\n\n  // decrease 1\n  function decrement() {\n    setCount((prevCount: number) => prevCount - 1);\n  }\n\n  // reset to initValue or 0\n  function reset() {\n    setCount(initialValue || 0);\n  }\n\n  return { count, setCount, increment, decrement, reset };\n}\n","import { useRef, useCallback, useEffect } from \"react\";\n\nexport function useDebouncedCallback<T extends (...args: any[]) => any>(\n  callback: T,\n  delay: number\n) {\n  const timerIdRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const debouncedCallback = useCallback(\n    (...args: Parameters<T>) => {\n      if (timerIdRef.current !== null) {\n        clearTimeout(timerIdRef.current);\n      }\n\n      timerIdRef.current = setTimeout(() => {\n        callback(...args);\n      }, delay);\n    },\n    [callback, delay]\n  );\n  useEffect(() => {\n    return () => {\n      if (timerIdRef.current !== null) {\n        clearTimeout(timerIdRef.current);\n      }\n    };\n  }, []);\n  return debouncedCallback;\n}\n","import axios, { Method, AxiosRequestConfig } from \"axios\";\nimport { useEffect, useState } from \"react\";\n\ntype UseFetchProps = {\n  method?: Method;\n  options?: AxiosRequestConfig;\n};\n\nexport function useFetch<T>(\n  url: string,\n  { method, options }: UseFetchProps = { method: \"GET\" }\n) {\n  const [data, setData] = useState<T | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string>(\"\");\n\n  async function fetchApi() {\n    try {\n      setLoading(true);\n      const res = await axios({ method, url, ...options });\n      setData(res.data);\n      setLoading(false);\n    } catch (err) {\n      console.error(err);\n      setError(err.message);\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    fetchApi();\n  }, [url]);\n\n  return { data, loading, error };\n}\n","import { useState, useEffect, useCallback } from \"react\";\nexport function useLocalStorage<T>(key: string, initialValue: T) {\n  const readInitValue = useCallback(() => {\n    try {\n      const item = localStorage.getItem(key);\n      if (!item) {\n        return initialValue;\n      }\n      try {\n        // 嘗試把item變成JSON解析\n        return JSON.parse(item);\n      } catch (e) {\n        // 如果只是純字串則回傳\n        return item;\n      }\n    } catch (err) {\n      console.error(\"Error reading from localStorage:\", err);\n      return initialValue;\n    }\n  }, [key, initialValue]);\n  const [storeState, setStoreState] = useState(readInitValue());\n  function setLocalStorage(value: T | ((prev: T) => T)) {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storeState) : value;\n      setStoreState(valueToStore);\n      // const valueToString = JSON.stringify(valueToStore);\n      // localStorage.setItem(key, valueToString);\n      localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(\"Set LocalStorage Error\", error);\n    }\n  }\n  useEffect(() => {\n    setLocalStorage(readInitValue());\n  }, []);\n  return [storeState, setLocalStorage] as const;\n}\n","import React, { useEffect, useRef } from \"react\";\n\nexport const useOutsideClick = <T extends HTMLElement>(\n  callback: () => void\n) => {\n  const ref = useRef<T | null>(null);\n\n  useEffect(() => {\n    const handleClick = (event: MouseEvent) => {\n      if (ref.current && !ref.current.contains(event.target as Node)) {\n        callback();\n      }\n    };\n\n    document.addEventListener(\"click\", handleClick);\n\n    return () => {\n      document.removeEventListener(\"click\", handleClick);\n    };\n  }, [callback]); // updated dependency array to include callback instead of ref\n\n  return ref;\n};\n","import { useState, useEffect, useCallback } from \"react\";\n\nexport function useSessionStorage<T>(key: string, initialValue: T) {\n  const readInitValue = useCallback(() => {\n    try {\n      const item = sessionStorage.getItem(key);\n      if (!item) {\n        return initialValue;\n      }\n      try {\n        // 嘗試把item變成JSON解析\n        return JSON.parse(item);\n      } catch (e) {\n        // 如果只是純字串則回傳\n        return item;\n      }\n    } catch (err) {\n      console.error(\"Error reading from sessionStorage:\", err);\n      return initialValue;\n    }\n  }, [key, initialValue]);\n  const [storeState, setStoreState] = useState<T>();\n  function setSessionStorage(value: T | ((prev: T) => T)) {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storeState) : value;\n      setStoreState(valueToStore);\n      const valueToString = JSON.stringify(valueToStore);\n      sessionStorage.setItem(key, valueToString);\n      sessionStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(\"Set sessionStorage Error\", error);\n    }\n  }\n  useEffect(() => {\n    setSessionStorage(readInitValue());\n  }, []);\n  return [storeState, setSessionStorage] as const;\n}\n","import { useEffect, useRef } from \"react\";\n\n// Custom Hook\nexport function useTimeout(callback: () => void, delay: number | null) {\n  const savedCallback = useRef<() => void>();\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    function fn() {\n      if (savedCallback.current) {\n        savedCallback.current();\n      }\n    }\n    if (delay !== null) {\n      const id = setTimeout(fn, delay);\n      return () => clearTimeout(id);\n    }\n  }, [delay]);\n}\n\n","import { useState, useEffect } from \"react\";\n\nexport function useWindowSize() {\n  const isClient = typeof window === \"object\";\n\n  const [width, setWidth] = useState<number>(isClient ? window.innerWidth : 0);\n  const [height, setHeight] = useState<number>(\n    isClient ? window.innerHeight : 0\n  );\n\n  useEffect(() => {\n    if (!isClient) return;\n    const handleResize = () => {\n      setWidth(window.innerWidth);\n      setHeight(window.innerHeight);\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => {\n      window.removeEventListener(\"resize\", handleResize);\n    };\n  }, [isClient]);\n\n  return { height, width };\n}\n"],"names":["cache","initialValue","_useState","useState","setCount","count","increment","prevCount","decrement","reset","callback","delay","timerIdRef","useRef","debouncedCallback","useCallback","_arguments","arguments","current","clearTimeout","setTimeout","apply","slice","call","useEffect","url","_temp","_ref","method","options","data","setData","_useState2","loading","setLoading","_useState3","error","setError","_temp2","Promise","resolve","axios","_extends","then","res","_catch","err","console","message","e","reject","fetchApi","headers","cacheKey","JSON","stringify","state","setState","controller","AbortController","signal","_error$response","code","response","status","fetchData","abort","key","readInitValue","item","localStorage","getItem","parse","storeState","setStoreState","setLocalStorage","value","valueToStore","Function","setItem","log","ref","handleClick","event","contains","target","document","addEventListener","removeEventListener","sessionStorage","setSessionStorage","valueToString","savedCallback","id","isClient","window","innerWidth","width","setWidth","innerHeight","height","setHeight","handleResize"],"mappings":"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"}